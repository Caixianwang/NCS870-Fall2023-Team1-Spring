(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07a6bcb3"],{"353b":function(t,e,i){},"909e":function(t,e,i){"use strict";i("353b")},a7dc:function(t,e,i){"use strict";var n=i("ed08");e["a"]={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var t=this;this.$_resizeHandler=Object(n["b"])((function(){t.chart&&t.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}}},ea08:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dashboard-editor-container"},[i("div",{staticStyle:{margin:"0 auto","text-align":"center",padding:"5px","font-weight":"bold"}},[t._v("Topology information in the last 5 minutes")]),i("el-row",{staticStyle:{background:"#fff",padding:"10px","margin-bottom":"0"}},[i("topo-chart")],1)],1)},a=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:{height:t.height,width:t.width}})},o=[],s=i("2909"),d=(i("a434"),i("d3b7"),i("6062"),i("3ca3"),i("ddb0"),i("b64b"),i("313e")),c=i("a7dc"),l=i("db51"),h=i("b775");i("817d");var u={mixins:[c["a"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"700px"}},data:function(){return{chart:null,currInterval:null,eachSize:600,topos:[],option:{animationDurationUpdate:1500,animationEasingUpdate:"cubicOut",series:[{type:"graph",layout:"none",symbolSize:5,roam:!0,label:{},edgeSymbol:["circle","arrow"],edgeSymbolSize:[4,10],edgeLabel:{fontSize:10},data:[],links:[]}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.chart=d["init"](t.$el,"macarons"),t.chart.setOption(t.option),t.queryList(),t.initChart()}))},beforeDestroy:function(){this.chart&&clearInterval(this.currInterval)},methods:{queryList:function(){var t=this;Object(h["a"])({url:"/getTopo",method:"get"}).then((function(e){var i=e.res;for(var n in i)if("topo"==n){t.topos=i[n];var a=t.topos.splice(0,t.eachSize);t.drawTopo(a),t.loopChart();break}})).catch((function(t){}))},loopChart:function(){var t=this;this.currInterval&&clearInterval(this.currInterval),this.currInterval=setInterval((function(){var e=t.topos.splice(0,t.eachSize);t.drawTopo(e)}),1e4)},drawTopo:function(t){var e=new Set,i=new Set;for(var n in t)e.add(t[n][0]),e.add(t[n][1]),t[n][0]==t[n][1]&&i.add(t[n][0]);this.buildCoordAxis(e,i),this.buildLinks(t),this.chart.setOption(this.option)},buildLinks:function(t){this.option.series[0].links.length=0;var e=new Set;for(var i in t)e.has(t[i][0]+""+t[i][1])||this.option.series[0].links.push({source:""+t[i][0],target:""+t[i][1]}),e.add(t[i][0]+""+t[i][1])},buildCoordAxis:function(t,e){for(var i=300,n=300,a=280,r=t.size,o=[],d=Object(s["a"])(t),c=0;c<r;c++){var l=c/r*2*Math.PI,h=i+a*Math.cos(l),u=n+a*Math.sin(l);o.push({val:d[c],x:h,y:u})}for(var f in this.option.series[0].data.length=0,o){var p={name:o[f].val,x:o[f].x,y:o[f].y};e.has(o[f].val)&&(p.itemStyle={borderColor:"blue",borderWidth:"5"}),this.option.series[0].data.push(p)}},initChart:function(){this.websocket()},websocket:function(){var t=this,e=new WebSocket(l["a"].WS_APP_BASE_API);e.onopen=function(){},e.onmessage=function(e){var i=JSON.parse(e.data);for(var n in i)if("topo"==n){t.topos=i[n];var a=t.topos.splice(0,t.eachSize);t.drawTopo(a)}},e.onclose=function(){console.log("连接已关闭...")},this.$router.afterEach((function(){e.close()}))}}},f=u,p=i("2877"),v=Object(p["a"])(f,r,o,!1,null,null,null),b=v.exports,m={name:"Topo01",components:{TopoChart:b},data:function(){return{}},mounted:function(){},methods:{}},_=m,z=(i("909e"),Object(p["a"])(_,n,a,!1,null,"49daa9a4",null));e["default"]=z.exports}}]);