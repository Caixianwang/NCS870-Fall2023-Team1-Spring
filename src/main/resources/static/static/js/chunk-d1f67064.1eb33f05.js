(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d1f67064"],{"22e9":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{padding:"2px"}},[i("div",{staticStyle:{height:"850px"},attrs:{id:"mapView"}})])}],o=i("3835"),a=(i("d3b7"),i("159b"),i("b64b"),i("e9c4"),i("90d7"),i("afaa")),s=i("b775"),c=i("db51"),l={name:"Gis01",components:{},data:function(){return{mapView:null,points:[],pointPoss:[],lines:[],gisDatas:[],eachSize:600,currInterval:null,basemap:"topo"}},mounted:function(){this.initMap(),this.queryList()},methods:{queryList:function(){var e=this;Object(s["a"])({url:"/getGis",method:"get"}).then((function(t){e.gisDatas=t.res.gis,e.loopChart(),e.websocket()})).catch((function(e){}))},loopChart:function(){var e=this;this.currInterval&&clearInterval(this.currInterval),this.currInterval=setInterval((function(){if(e.gisDatas.length>0){var t=e.gisDatas.shift();e.drawLocation(t)}}),2e3)},drawLocation:function(e){var t=this;Object(a["loadModules"])(["esri/Graphic","esri/geometry/Point","esri/geometry/Polyline","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol"]).then((function(i){var n=Object(o["a"])(i,5),r=n[0],a=n[1],s=n[2],c=n[3],l=n[4];if(t.lines.length>0){var u=new c({color:[0,0,255]}),d=new l({color:[0,0,255]});t.mapView.graphics.forEach((function(e){"point"===e.geometry.type?e.symbol=u:"polyline"===e.geometry.type&&(e.symbol=d)}))}var p=e[0],m=e[1],f=new a({longitude:p.lng,latitude:p.lat}),g=new a({longitude:m.lng,latitude:m.lat}),h={type:"simple-marker",style:"circle",color:[255,0,0],size:10,outline:{color:[255,0,0],width:1}},w=new r({geometry:f,symbol:h}),v=new r({geometry:g,symbol:h});t.points.push(w),t.points.push(v),t.mapView.graphics.add(w),t.mapView.graphics.add(v);var y=new s({paths:[[p.lng,p.lat],[m.lng,m.lat]]}),b={type:"simple-line",color:[255,0,0],width:.05},P=new r({geometry:y,symbol:b});t.mapView.graphics.add(P),t.lines.push(P),t.lines.length>10&&(t.mapView.graphics.remove(t.points.shift()),t.mapView.graphics.remove(t.points.shift()),t.mapView.graphics.remove(t.lines.shift())),t.mapView.goTo({target:g,animate:{duration:1e3,easing:"in-out-expo"}})}))},initMap:function(){var e=this;Object(a["loadModules"])(["esri/Map","esri/views/SceneView","esri/widgets/Compass","esri/widgets/Fullscreen","esri/widgets/Home","esri/widgets/BasemapGallery","esri/widgets/Expand","esri/Graphic","esri/geometry/Point"]).then((function(t){var i=Object(o["a"])(t,9),n=i[0],r=i[1],a=(i[2],i[3]),s=i[4],c=i[5],l=i[6],u=(i[7],i[8],new n({basemap:"streets"}));e.mapView=new r({container:"mapView",map:u,center:[47.3667,8.55],zoom:7});var d=new a({view:e.mapView});e.mapView.ui.add(d,"top-left");var p=new s({view:e.mapView});e.mapView.ui.add(p,"top-left");var m=new c({view:e.mapView,autoOpen:!1}),f=new l({view:e.mapView,content:m,expanded:!1});e.mapView.ui.add(f,"top-left")}))},websocket:function(){var e=this,t=new WebSocket(c["a"].WS_APP_BASE_API);t.onopen=function(){},t.onmessage=function(t){var i=JSON.parse(t.data);for(var n in i)"gis"==n&&(e.gisDatas=i[n],console.log(JSON.stringify(e.gisDatas)),e.loopChart())},t.onclose=function(){console.log("连接已关闭...")},this.$router.afterEach((function(){t.close()}))},doPointLine:function(){var e=this;Object(a["loadModules"])(["esri/Graphic","esri/geometry/Point","esri/geometry/Polyline"]).then((function(t){var i=Object(o["a"])(t,3),n=i[0],r=i[1],a=i[2],s={longitude:.1*(Math.random()-.5)-123.1216,latitude:49.2827+.1*(Math.random()-.5)};e.pointPoss.push(s);var c=new r({longitude:s.longitude,latitude:s.latitude}),l={type:"simple-marker",style:"circle",color:[255,0,0],size:10,outline:{color:[0,0,0],width:1}},u=new n({geometry:c,symbol:l});e.mapView.graphics.add(u),e.points.push(u);var d=e.pointPoss.length;if(d>=2){var p=new a({paths:[[e.pointPoss[d-2].longitude,e.pointPoss[d-2].latitude],[e.pointPoss[d-1].longitude,e.pointPoss[d-1].latitude]]}),m={type:"simple-line",color:[0,0,255],width:2},f=new n({geometry:p,symbol:m});e.mapView.graphics.add(f),e.lines.push(f),e.pointPoss.length>5&&(e.pointPoss.shift(),e.mapView.graphics.remove(e.points.shift()),e.mapView.graphics.remove(e.lines.shift()))}e.mapView.goTo({target:c,zoom:12,animate:{duration:1e3,easing:"in-out-expo"}})}))},doLine:function(){var e=this;Object(a["loadModules"])(["esri/Graphic","esri/geometry/Point","esri/geometry/Polyline","esri/geometry/geometryEngine"]).then((function(t){var i=Object(o["a"])(t,4),n=i[0],r=i[1],a=i[2],s=i[3],c=new r({longitude:-118,latitude:34}),l=new r({longitude:-119,latitude:35}),u={type:"simple-marker",style:"circle",color:[255,0,0],size:10,outline:{color:[0,0,0],width:1}},d=new n({geometry:c,symbol:u}),p=new n({geometry:l,symbol:u}),m=new a({paths:[[c.longitude,c.latitude],[l.longitude,l.latitude]]}),f={type:"simple-line",color:[0,0,255],width:2},g=new n({geometry:m,symbol:f});e.mapView.graphics.addMany([d,p,g]);var h=s.geodesicLength(m,"meters");console.log(h);var w=Math.max(2,Math.round(Math.log2(591657550.5/h))),v=[(c.longitude+l.longitude)/2,(c.latitude+l.latitude)/2];console.log(v),e.mapView.goTo({center:v,zoom:w-3,animate:!0})}))},doPoint:function(){var e=this;Object(a["loadModules"])(["esri/Graphic","esri/geometry/Point"]).then((function(t){var i=Object(o["a"])(t,2),n=i[0],r=i[1],a=new r({longitude:-118,latitude:34}),s={type:"simple-marker",style:"circle",color:[255,0,0],size:10,outline:{color:[0,0,0],width:1}},c=new n({geometry:a,symbol:s});e.mapView.graphics.add(c),e.mapView.goTo({target:a,zoom:13,animate:{duration:5e3,easing:"in-out-cubic"}})}))}},beforeDestroy:function(){clearInterval(this.currInterval)}},u=l,d=(i("9488"),i("2877")),p=Object(d["a"])(u,n,r,!1,null,"fdfe60c4",null);t["default"]=p.exports},"90d7":function(e,t,i){var n=i("23e7"),r=Math.log,o=Math.LN2;n({target:"Math",stat:!0},{log2:function(e){return r(e)/o}})},9488:function(e,t,i){"use strict";i("fd87")},afaa:function(e,t,i){(function(e,i){i(t)})(0,(function(e){"use strict";var t="undefined"!==typeof window,i={Promise:t?window["Promise"]:void 0},n="4.25",r="next";function o(e){if(e.toLowerCase()===r)return r;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function a(e){return void 0===e&&(e=n),"https://js.arcgis.com/".concat(e,"/")}function s(e){void 0===e&&(e=n);var t=a(e),i=o(e);if(i!==r&&3===i.major){var s=i.minor<=10?"js/":"";return"".concat(t).concat(s,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function c(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function l(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}function u(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||o(e)?s(e):e}function p(e,t){var i=d(e),n=u(i);return n||(n=c(i),l(n,t)),n}var m={};function f(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function g(e,t,i){var n;i&&(n=h(e,i));var r=function(){t(e),e.removeEventListener("load",r,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",r,!1)}function h(e,t){var i=function(n){t(n.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",i,!1)};return e.addEventListener("error",i,!1),i}function w(e){void 0===e&&(e={}),m=e}function v(){return document.querySelector("script[data-esri-loader]")}function y(){var e=window["require"];return e&&e.on}function b(e){void 0===e&&(e={});var t={};[m,e].forEach((function(e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}));var n=t.version,r=t.url||a(n);return new i.Promise((function(e,i){var o=v();if(o){var a=o.getAttribute("src");a!==r?i(new Error("The ArcGIS API for JavaScript is already loaded (".concat(a,")."))):y()?e(o):g(o,e,i)}else if(y())i(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;if(s){var c=!0===s;p(c?n:s,t.insertCssBefore)}o=f(r),g(o,(function(){o.setAttribute("data-esri-loader","loaded"),e(o)}),i),document.body.appendChild(o)}}))}function P(e){return new i.Promise((function(t,i){var n=window["require"].on("error",i);window["require"](e,(function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];n.remove(),t(e)}))}))}function V(e,t){if(void 0===t&&(t={}),y())return P(e);var i=v(),n=i&&i.getAttribute("src");return!t.url&&n&&(t.url=n),b(t).then((function(){return P(e)}))}e.utils=i,e.loadModules=V,e.getScript=v,e.isLoaded=y,e.loadScript=b,e.setDefaultOptions=w,e.loadCss=p,Object.defineProperty(e,"__esModule",{value:!0})}))},e9c4:function(e,t,i){var n=i("23e7"),r=i("d066"),o=i("d039"),a=r("JSON","stringify"),s=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(e,t,i){var n=i.charAt(t-1),r=i.charAt(t+1);return c.test(e)&&!l.test(r)||l.test(e)&&!c.test(n)?"\\u"+e.charCodeAt(0).toString(16):e},d=o((function(){return'"\\udf06\\ud834"'!==a("\udf06\ud834")||'"\\udead"'!==a("\udead")}));a&&n({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,i){var n=a.apply(null,arguments);return"string"==typeof n?n.replace(s,u):n}})},fd87:function(e,t,i){}}]);