(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-188f8a8d"],{"4ec9":function(t,e,i){"use strict";var a=i("6d61"),n=i("6566");t.exports=a("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n)},"6d65":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dashboard-editor-container"},[i("el-row",{staticStyle:{background:"#fff",padding:"35px","margin-bottom":"0"}},[i("matrix-chart")],1)],1)},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:{height:t.height,width:t.width}})},o=[],s=i("2909"),c=i("3835"),d=i("b85c"),h=(i("a434"),i("d3b7"),i("6062"),i("3ca3"),i("ddb0"),i("a630"),i("4ec9"),i("159b"),i("b64b"),i("313e")),l=i("a7dc"),u=i("db51"),f=i("b775");i("817d");var v={mixins:[l["a"]],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"750px"}},data:function(){return{chart:null,currInterval:null,axisData:[],topos:[],option:{title:{text:"Path correlation"},legend:{show:!1,data:["Path correlation"],left:"right"},tooltip:{position:"top",backgroundColor:"rgba(255,255,150,0.1)",textStyle:{color:"#a41a1a",fontSize:20,fontWeight:"bold"},formatter:function(t){var e=t["data"],i="The times of routes from AS"+e[0]+" to AS"+e[1]+" is "+e[2];return i}},grid:{left:2,bottom:10,right:20,containLabel:!0},xAxis:{type:"category",data:[],boundaryGap:!1,splitLine:{show:!0},axisLine:{show:!1},axisLabel:{rotate:-45,interval:45}},yAxis:{type:"category",data:[],axisLine:{show:!1},axisLabel:{rotate:-45,interval:65}},series:[{name:"Path correlation",type:"scatter",symbolSize:function(t){return t[2]<5?3:t[2]<20?6:t[2]<50?8:t[2]<100?10:t[2]<200?15:t[2]<300?20:26},data:[],animationDelay:function(t){return 5*t}}]}}},mounted:function(){var t=this;this.$nextTick((function(){t.chart=h["init"](t.$el,"macarons"),t.chart.setOption(t.option),t.queryList(),t.initChart()}))},beforeDestroy:function(){this.chart&&clearInterval(this.currInterval)},methods:{queryList:function(){var t=this;Object(f["a"])({url:"/getTopo",method:"get"}).then((function(e){var i=e.res;for(var a in i)if("topo"==a){t.topos=i[a],t.buildData();var n=t.topos.splice(0,t.eachSize);t.drawTopo(n),t.loopChart();break}})).catch((function(t){}))},shuffleArray:function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),a=[t[i],t[e]];t[e]=a[0],t[i]=a[1]}return t},buildData:function(){var t,e=new Set,i=Object(d["a"])(this.topos);try{for(i.s();!(t=i.n()).done;){var a=t.value;e.add(a[0]),e.add(a[1])}}catch(m){i.e(m)}finally{i.f()}this.option.xAxis.data=this.shuffleArray(Array.from(e)),this.option.yAxis.data=this.shuffleArray(Array.from(e));var n,r=new Map,o=Object(d["a"])(this.topos);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s[0]!=s[1]){var h=s[0]+","+s[1],l=1;r.has(h)&&(l+=r.get(h)),r.set(h,l)}}}catch(m){o.e(m)}finally{o.f()}var u,f=Object(d["a"])(r);try{for(f.s();!(u=f.n()).done;){var v=Object(c["a"])(u.value,2),p=v[0],b=v[1],y=p.split(",");this.option.series[0].data.push([y[1],y[0],b])}}catch(m){f.e(m)}finally{f.f()}this.chart.setOption(this.option)},buildData1:function(){var t,e=this,i=new Set,a=Object(d["a"])(this.topos);try{for(a.s();!(t=a.n()).done;){var n=t.value;i.add(n[0]),i.add(n[1])}}catch(_){a.e(_)}finally{a.f()}var r=1,o=new Map;i.forEach((function(t){e.option.xAxis.data.push(r),e.option.yAxis.data.push(r),o.set(t,r),r+=1}));var s,h=new Map,l=Object(d["a"])(this.topos);try{for(l.s();!(s=l.n()).done;){var u=s.value;if(u[0]!=u[1]){var f=o.get(u[0])+","+o.get(u[1]),v=1;h.has(f)&&(v+=h.get(f),console.log(v)),h.set(f,v)}}}catch(_){l.e(_)}finally{l.f()}var p,b=Object(d["a"])(h);try{for(b.s();!(p=b.n()).done;){var y=Object(c["a"])(p.value,2),m=y[0],w=y[1],g=m.split(",");this.option.series[0].data.push([g[0],g[1],w])}}catch(_){b.e(_)}finally{b.f()}this.chart.setOption(this.option)},loopChart:function(){var t=this;this.currInterval&&clearInterval(this.currInterval),this.currInterval=setInterval((function(){var e=t.topos.splice(0,t.eachSize);t.drawTopo(e)}),1e4)},drawTopo:function(t){var e=new Set,i=new Set;for(var a in t)e.add(t[a][0]),e.add(t[a][1]),t[a][0]==t[a][1]&&i.add(t[a][0]);this.buildCoordAxis(e,i),this.buildLinks(t),this.chart.setOption(this.option)},buildLinks:function(t){this.option.series[0].links.length=0;var e=new Set;for(var i in t)e.has(t[i][0]+""+t[i][1])||this.option.series[0].links.push({source:""+t[i][0],target:""+t[i][1]}),e.add(t[i][0]+""+t[i][1])},buildCoordAxis:function(t,e){for(var i=300,a=300,n=280,r=t.size,o=[],c=Object(s["a"])(t),d=0;d<r;d++){var h=d/r*2*Math.PI,l=i+n*Math.cos(h),u=a+n*Math.sin(h);o.push({val:c[d],x:l,y:u})}for(var f in this.option.series[0].data.length=0,o){var v={name:o[f].val,x:o[f].x,y:o[f].y};e.has(o[f].val)&&(v.itemStyle={borderColor:"blue",borderWidth:"5"}),this.option.series[0].data.push(v)}},initChart:function(){this.websocket()},websocket:function(){var t=this,e=new WebSocket(u["a"].WS_APP_BASE_API);e.onopen=function(){},e.onmessage=function(e){var i=JSON.parse(e.data);for(var a in i)if("topo"==a){t.topos=i[a];var n=t.topos.splice(0,t.eachSize);t.drawTopo(n)}},e.onclose=function(){console.log("连接已关闭...")},this.$router.afterEach((function(){e.close()}))}}},p=v,b=i("2877"),y=Object(b["a"])(p,r,o,!1,null,null,null),m=y.exports,w={name:"Topo01",components:{MatrixChart:m},data:function(){return{}},mounted:function(){},methods:{}},g=w,_=(i("aeec"),Object(b["a"])(g,a,n,!1,null,"3c07d573",null));e["default"]=_.exports},a4d6:function(t,e,i){},a7dc:function(t,e,i){"use strict";var a=i("ed08");e["a"]={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var t=this;this.$_resizeHandler=Object(a["b"])((function(){t.chart&&t.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}}},aeec:function(t,e,i){"use strict";i("a4d6")}}]);